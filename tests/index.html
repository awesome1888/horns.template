<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Horns tests</title>
</head>
<body>

<h1>Horns test page</h1>

<script src="../src/js/horns.js"></script>
<script>

	var helpers = {
		quote: function(arg){
			return '&laquo;'+arg+'&raquo;';
		},
		implodeArgs: function(){
			return Array.prototype.slice.call(arguments).join(', ');
		},
		implode: function(arg){
			return arg.join(', ');
		},
		ucFirst: function(arg){
			arg = arg.toString();
			return arg.substr(0, 1).toUpperCase()+arg.substr(1);
		},
		totalPrice: function(arg){
			var sum = 0;
			for(var k = 0; k < arg.length; k++)
			{
				sum += parseInt(arg[k].price);
			}
			return sum;
		}
	};

	var tests = [
		{
			data: {
				personA: 'brown fox',
				personB: 'dog'
			},
			template: 'The quick {{quote personA}} jumps over the lazy {{quote personB}}',
		},
		{
			data: {
				guestName: 'Steve',
				meal: [
					{
						title: 'breakfast',
						time: '9:00 am',
						menu: ['Coffee cup', 'Sandwich', 'Cigarette']
					},
					{
						title: 'dinner',
						time: '1:00 pm',
						menu: ['Vegetable salad', 'Mushroom soup', 'Cherry compote', 'Bread']
					},
					{
						title: 'supper',
						time: '6:00 pm',
						menu: ['Sausages with roasted potatoes', 'Tea cup', 'Apple pie', 'Good movie to watch']
					}
				],
			},
			template: "<h3>Dear {{guestName}}, your menu for today is:</h3>" +
			"<ul>" +
			"{{#meal}}" +
				"<li>" +
					"<b>{{ucFirst title}}</b><br />" +
					"Time: {{time}}<br />" +
					"Dishes: {{implode menu}}" +
				"</li>" +
			"{{/meal}}" +
			"</ul>"
		},
		{
			data: {
				positions: {
					length: 3,
					0: {
						price: 300
					},
					1: {
						price: 700
					},
					2: {
						price: 1500
					}
				},
				payment: [
					{title: 'Visa/Master Card', value: 'card'},
					{title: 'Cash', value: 'cash', default: true},
				]
			},
			template: "<h3>Your order is:</h3>" +
			"Total price: ${{totalPrice positions}}<br />" +
			"Pay with: " +
			"<select>" +
				"{{#payment}}" +
					"<option value=\"{{value}}\" {{#if default}} selected=\"selected\"{{/if}}>{{title}}</option>"+
				"{{/payment}}" +
			"</select>"
		}
	];

	var k, j, template;

	for(k in tests)
	{
		template = new Horns.compile(tests[k].template);
		for(j in helpers)
		{
			template.registerHelper(j, helpers[j]);
		}

        document.write(template.get(tests[k].data));
		document.write('<hr />');
    }

</script>


</body>
</html>